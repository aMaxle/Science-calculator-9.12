# Science-calculator-9.12
#include <iostream>
#include <cstring>
#include <cmath>

using namespace std;

int bi[32]={0},bi2[32]={0};
int octal[11] = {0},octal2[11]={0};
char hexa[8] = {0},hexa2[8]={0};

void getBi(char x[]){
    int j = 31;
    for (int i = 99; i > 1;i--){
        if(x[i]==0)
            continue;
        bi[j] = x[i] - '0';
        j--;
    }
}

int getDec(char x[]){
    int decNum=0,n=0;
    int leap = 0;
    if(x[0]=='-'){
        leap = 1;
    }
    for (int i = 99; i >= 0;i--){
        if(x[i]=='-')
            continue;
        if(x[i]){
            decNum += (x[i] - '0') * pow(10, n);
            n++;
        }
    }
    if(leap)
        decNum = - decNum;
    return decNum;
}

int biErr(char x[]){
    for (int i = 0; x[i] ;i++){
        if(x[i]=='b'||x[i]=='B')
            continue;
        if(x[i]!='1'&&x[i]!='0')
            return 1;
    }
    return 0;
}

int octErr(char x[]){
    for(int i=0;x[i];i++){
        if((x[i]>='0'&&x[i]<='7'))
            continue;
        else 
            return 1;
    }
    return 0;
}

int decErr(char x[]){
    for(int i=0;x[i];i++){
        if((x[i]>='0'&&x[i]<='9')||x[i]=='.'||x[i]=='-')
            continue;
        else 
            return 1;
    }
    return 0;
}

int hexErr(char x[]){
    for (int i = 2; x[i] ;i++){
        if(x[i]>='0'&&x[i]<='9'||x[i]>='A'&&x[i]<='F'||x[i]>='a'&&x[i]<='f')
            continue;
        else
            return 1;
    }
    return 0;
}

void DecToBinary(int a){     // 十进制转二进制值
    int j=1;
    int cmpNum;
    if(a<0){
        int leap=1;
        a = abs(a);
        bi[0] = 1;
        for (int i = 30; i >=0;i--){
            cmpNum = pow(2, i);
            if(a>=cmpNum){
                bi[j]= 1;
                a = a - cmpNum;
                j++;
            }
            else if(a<cmpNum&&a>=0){
                bi[j] = 0;
                j++;
            }
        }
        for(int i=31;i>0;i--){
            if(leap){
                if(bi[i]==0)
                    continue;
                else {
                    leap = 0;
                    continue;
                }
            }
            else{
                if(bi[i] == 1)
                    bi[i] = 0;
                else 
                    bi[i] = 1;
            }
        }
    }
    else if(a>=0){
        bi[0] = 0;
        for (int i = 30; i >=0;i--){
            cmpNum = pow(2, i);
            if(a>=cmpNum){
                bi[j] = 1;
                a = a - cmpNum;
                j++;
            }
            else if(a<cmpNum&&a>=0){
                bi[j] = 0;
                j++;
            }
        }
    }
}

void printBinary(int x[]){   // 打印二进制值
    int is0 = 1;
    for(int i=0;i<32;i++){
        if(x[i]==1){
            is0 = 0;
            break;
        }
    }
    if(is0)
        cout << '0' << endl;
    else{
        if(x[0]==1){
            for(int i=0;i<32;i++){
                cout<<x[i];
                if(i==7||i==15||i==23)
                    cout<<' ';
            }
        }
        else{
            int leap = 1;
            for(int i=0;i<32;i++){
                if(x[i]==0&&leap){
                    leap = 1;
                    continue;
                }
                else{
                    leap = 0;
                    cout<<x[i];
                }
            }
        }
        cout<<endl;
    }
}

void BiToOct(int x[]){
    int m = 10, sum = 0, k = 0, leap = 1;
    for(int i=31;i>=0;i--){
        sum += x[i] * pow(2, k);
        if(i==0)
            octal[m] = sum;
        k++;
        if(k==3){
            k = 0;
            octal[m] = sum;
            m--;
            sum = 0;
        }
    }
    cout << "八进制值：";
    if(x[0]==1){
        for (int i = 0; i < 11;i++){
            cout << octal[i];
        }
    }
    else{
        for (int i = 0; i < 11;i++){
            if(octal[i]==0&&leap)
                continue;
            else{
                cout << octal[i];
                leap = 0;
            }
        }
    }
    cout << endl;
    
}

int BiToDec(int x[]){
    int sum = 0, k = 0;
    for(int i=31;i>=0;i--){
        sum += x[i] * pow(2, k);
        k++;
    }
    return sum;
}

int OctToDec(char x[]){
    int j = 10 , decNum = 0 , k = 0;
    for (int i = 10; i >= 1;i--){
        if(x[i]){
            decNum += (x[i] - '0') * pow(8, k);
            k++;
            j--;
        }
    }
    return decNum;
}

int HexToDec(char x[]){     // 十六进制转十进制的值
    int num = 0;
    int j = 0;
    for (int i = 9; i >= 2;i--){
        if(x[i]>'9'){
            switch(x[i]){
                case 'a':
                    num += 10 * pow(16,j);
                    break;
                case 'A':
                    num += 10 * pow(16,j);
                    break;
                case 'b':
                    num += 11 * pow(16,j);
                    break;
                case 'B':   
                    num += 11 * pow(16,j);
                    break;
                case 'c':
                    num += 12 * pow(16,j);
                    break;
                case 'C':
                    num += 12 * pow(16,j);
                    break;
                case 'd':
                    num += 13 * pow(16,j);
                    break;
                case 'D':
                    num += 13 * pow(16,j);
                    break;
                case 'e':
                    num += 14 * pow(16,j);
                    break;
                case 'E':
                    num += 14 * pow(16,j);
                    break;
                case 'f':
                    num += 15 * pow(16,j);
                    break;
                case 'F':
                    num += 15 * pow(16,j);
                    break;
            }
            j++;
        }
        else if(x[i]>='0'&&x[i]<='9'){
            num += (x[i] - '0') * pow(16,j);
            j++;
        }
    }
    return num;
}

void printMulAndDiv(int a,int b){
    int c,m,t;
    if(a<b){
        t=a;
        a=b;
        b=t;
    }
    m=a*b;
    c=a%b;
    while(c!=0){
        a=b;
        b=c;
        c=a%b;
    }
    cout << "最大公约数是:" << b << endl;
    cout << "最小公倍数是:" << m / b << endl;
}

void BiToHex(int x[]){
    memset(hexa, '0', sizeof(hexa));
	int m = 7, sum = 0, k = 0, leap = 1;
    int is0 = 1;
    for(int i=0;i<32;i++){
        if(x[i]==1){
            is0 = 0;
            break;
        }
    }
    if(is0)
        cout << '0' << endl;
    else{
        cout << "0x";
        for(int i=31;i>=0;i--){
            sum += bi[i] * pow(2, k);
            k++;
            if(k==4){
                k = 0;
                if(sum>9){
                    switch(sum){
                        case 10:hexa[m]='A';
                        break;
                        case 11:hexa[m]='B';
                        break;
                        case 12:hexa[m]='C';
                        break;
                        case 13:hexa[m]='D';
                        break;
                        case 14:hexa[m]='E';
                        break;
                        case 15:hexa[m]='F';
                    }
                }
                else
                    hexa[m] = sum+'0';
                m--;
                sum = 0;
            }
        }
        if(x[0]==1){
            for (int i = 0; i < 8;i++){
                cout << hexa[i];
            }
        }
        else if(x[0]==0){
            for (int i = 0; i < 8;i++){
                if(hexa[i]=='0'&&leap)
                    continue;
                else{
                    cout << hexa[i];
                    leap = 0;
                }
            }
        }
        cout << endl;
    }
} 

void powE(char x[]){        // 以e为底的指数
    double a = 0, b = 0, c = 0;
    int i = 99, n = 0;
    for (; i >= 0;i--){
        if(x[i]=='^'){
            n = 0;
            break;
        }
        if(x[i]==')'||x[i]=='(')
            continue;
        if(x[i]=='+')
            continue;
        else if(x[i]=='-'){
            b = 0 - b;
            n = 0;
            continue;
        }
        if(isdigit(x[i])){
            b += (x[i] - '0') * pow(10, n);
            n++;
        }
    }
    i--;
    for (; i >= 0;i--){
        if(x[i]==')'||x[i]=='(')
            continue;
        else if(x[i]=='-'){
            if(a==0)
                a = 1;
            a = 0 - a;
            n = 0;
            break;
        }
        if(isdigit(x[i])){
            a += (x[i] - '0') * pow(10, n);
            n++;
        }
    }
}

void funTri(char x[]){
    double result=0;
    int a=0,n = 0,k=0,i = 99,isDecimal = 0;
    for (; i >= 0;i--){
        if(x[i]=='n'||x[i]=='s')
            break;
        if(x[i]==')'||x[i]=='('||x[i]=='.')
            continue;
        if(x[i]=='-'){
            result = 0 - result;
            continue;
        }
        if(x[i]){
            result += (x[i] - '0') * pow(10, n);
            n++;
        }
    }
    i = i - 3;
    n = 0;
    for (int j = 99; j >= 0;j--){
        if(x[j]=='.'){
            isDecimal = 1;
            break;
        }
        if(x[j])
            k--;
    }
    if(isDecimal)
        result *= pow(10, k);
    for (; i >= 0; i--){
        if(x[i]==')'||x[i]=='(')
            continue;
        if(x[i]=='-'){
            if(a==0)
                a = 1;
            a = 0 - a;
            break;
        }
        if (x[i]){
            a += (x[i] - '0') * pow(10, n);
            n++;
        }
    }
    if(a==0)
        a = 1;
    cout << a << ' ' << result << endl;
    result = (result/180.0)*M_PI;
    
    cout << "结果是：" ;
    for (int j = 0; j < 100;j++){
        if(x[j]=='s'){
            cout << a * sin(result) << endl;
            break;
        }
        else if(x[j]=='c'){
            if(sin(result)==0)
                cout << a * sqrt(1-sin(result)*sin(result)) << endl;
            else
                cout << a * cos(result) << endl;
            break;
        }
        else if(x[j]=='t'){
            cout << a * tan(result) << endl;
            break;
        }
    }
}

void Logar(char x[]){
    double a = 0, b = 0,logdown=0;
    int i = 99, j = 99, n = 0,k=0,isDecimal=0;
    for (; i >= 0;i--){
        if(x[i]=='g'||x[i]=='n'||x[i]==')'){
            n = 0;
            break;
        }
        if(x[i]=='-')
            break;
        if(isdigit(x[i])){
            b += (x[i] - '0') * pow(10, n);
            n++;
        }
    }
    i--;
    for (; j >= 0;j--){
        if(x[j]=='g'||x[j]=='n'||x[j]==')')
            break;
        if(x[j]=='.'){
            isDecimal = 1;
            continue;
        }
        if(x[j]=='('||x[j]==')')
            continue;
        if(x[j]&&!isDecimal)
            k--;
    }
    if(isDecimal){
        b *= pow(10, k);
        k = 0;
        isDecimal = 0;
    }
    j--;
    k = 0;
    for (; i >= 0;i--){
        if(x[i]=='.'){
            isDecimal = 1;
            continue;
        }
        if(x[i]=='('){
            i = i - 4;
            j = j - 4;
            n = 0;
            break;
        }
        else if(x[i]=='o'){
            logdown = 10;
            i = i - 2;
            j = j - 2;
            break;
        }   
        else if(x[i]=='l'){
            logdown = 1;
            i = i - 1;
            j = j - 1;
            break;
        }
        if(x[i]&&!isDecimal)
            k--;
        logdown += (x[i] - '0') * pow(10, n);
        n++;
    }
    if(isDecimal){
        logdown *= pow(10, k);
        k = 0;
        isDecimal = 0;
    }
    for (; i >= 0;i--){
        if(x[i]=='-'){
            if (a == 0)
                a = 1;
            a = 0 - a;
            break;
        }
        a += (x[i] - '0') * pow(10, n);
        n++;
    }
    if (a == 0)
        a = 1;
    for (; j >= 0;j--){
        if(x[j]=='.'){
            isDecimal = 1;
            continue;
        }
        if(x[j]==')'||x[j]=='(')
            continue;
        if(x[j]&&!isDecimal)
            k--;
    }
    if(isDecimal){
        a *= pow(10, k);
        isDecimal = 0;
    }
    if(logdown==10)
        cout << "结果是：" << a*log10(b) << endl;
    else if(logdown==1)
        cout << "结果是：" << a*log(b) << endl;
    else
        cout << "结果是：" << a*(log(b)/log(logdown)) << endl;
}

void Power(char x[]){
    double a = 0, b = 0, c = 0;
    int i = 99,j=99, n = 0,isDecimal=0,k=0;
    for (; i >= 0;i--){
        if(x[i]=='^'){
            n = 0;
            break;
        }
        if(x[i]==')'||x[i]=='('||x[i]=='.')
            continue;
        if(x[i]=='+')
            continue;
        else if(x[i]=='-'){
            b = 0 - b;
            n = 0;
            continue;
        }
        if(isdigit(x[i])){
            b += (x[i] - '0') * pow(10, n);
            n++;
        }
    }
    
    for (; j >= 0;j--){
        if(x[j]=='^')
            break;
        if(x[j]=='.'){
            isDecimal = 1;
            continue;
        }
        if(x[j]=='('||x[j]==')')
            continue;
        if(x[j]&&!isDecimal)
            k--;
    }
    j--;
    if(isDecimal){
        b *= pow(10, k);
        k = 0;
        isDecimal = 0;
    }
    i--;
    for (; i >= 0;i--){
        if(x[i]==')'||x[i]=='('||x[i]=='.')
            continue;
        else if(x[i]=='-'){
            if(a==0)
                a = 1;
            a = 0 - a;
            n = 0;
            break;
        }
        if(isdigit(x[i])){
            a += (x[i] - '0') * pow(10, n);
            n++;
        }
    }
    if(a==0)
        a = 1;
    k = 0;
    for (; j >= 0;j--){
        if(x[j]=='.'){
            isDecimal = 1;
            continue;
        }
        if(x[j]==')'||x[j]=='(')
            continue;
        if(x[j]&&!isDecimal)
            k--;
    }
    if(isDecimal){
        a *= pow(10, k);
        isDecimal = 0;
    }
    if(x[0]=='-')
        cout << "结果是：" << 0-pow(a,b) << endl;
    else
        cout << "结果是：" << pow(a, b) << endl;
}

void Oneoff(char x[]){      // 一元一次方程求解
    double k=0, b=0, num[10]={0};
    int i = 99, m = 9, n = 0 ,leap = 0, k_Neg = 0, b_Neg = 0;
    for (; i >= 0;i--){
        if (x[i] == '='){
            n = 0;
            break;
        }
        if(x[i]=='-')
            b_Neg = 1;
        if(isdigit(x[i])){
            num[m] += (x[i] - '0') * pow(10, n);
            n++;
        }
    }
    m--;
    i--;
    for (; i >= 0;i--){
        if(x[i]=='x'){
            n = 0;
            i--;
            leap = 1;
            break;
        }
        if(isdigit(x[i])){
            num[m] += (x[i] - '0') * pow(10, n);
            n++;
        }
    }
    i--;
    for (; i >= 0;i--){
        if(x[i]=='-'){
            k_Neg = 1;
            break;
        }
        k += (x[i] - '0') * pow(10, n);
        n++;
    }
    if (leap && k == 0)
        k = 1;
    if(k_Neg)
        k = 0 - k;
    b = num[9];
    if(b_Neg)
        b = 0 - b;
    for (int j = 8; j >= 0;j--){
        b -= num[j];
    }
    cout << "x = " << k / b<<endl;
}

void Inverse(char x[]){     // 反比例函数求解
    double k=0, b=0, num[10]={0};
    int i = 99, m = 9, n = 0 ,leap = 0, k_Neg = 0,b_Neg = 0;
    for (; i >= 0;i--){
        if (x[i] == '='){
            n = 0;
            break;
        }
        if(x[i]=='-')
            b_Neg = 1;
        if(isdigit(x[i])){
            num[m] += (x[i] - '0') * pow(10, n);
            n++;
        }
    }
    m--;
    i--;
    for (; i >= 0;i--){
        if(x[i]=='x'){
            n = 0;
            leap = 1;
            break;
        }
        if(x[i]=='+'){
            m--;
            n = 0;
            continue;
        }
        else if(x[i]=='-'){
            num[m] = 0 - num[m];
            m--;
            n = 0;
            continue;
        }
        if(isdigit(x[i])){
            num[m] += (x[i] - '0') * pow(10, n);
            n++;
        }
    }
    i--;
    for (; i >= 0;i--){
        if(x[i]=='-'){
            k_Neg = 1;
            break;
        }
        k += (x[i] - '0') * pow(10, n);
        n++;
    }
    if (leap && k == 0)
        k = 1;
    if(k_Neg)
        k = 0 - k;
    b = num[9];
    if(b_Neg)
        b = 0 - b;
    for (int j = 8; j >= 0;j--){
        b -= num[j];
    }
    cout << "x = " << b / k << endl;
}

void Quadratic(char x[]){   // 一元二次方程求解
    double delta = 0, x1, x2,a = 0, b = 0, c = 0, d = 0;
    int root,haveX=1;
    int i = 99, n = 0;
    for (; i >= 0;i--){
        if (x[i] == '='){
            n = 0;
            break;
        }
        if(x[i]=='-'){
            d = 0 - d;
            n = 0;
            continue;
        }
        if(isdigit(x[i])){
            d += (x[i] - '0') * pow(10, n);
            n++;
        }
    }
    i--;
    for (; i >= 0;i--){
        if(x[i]=='x'){
            n = 0;
            break;
        }
        if(x[i]=='+'){
            n = 0;
            break;
        }
        else if(x[i]=='-'){
            c = 0 - c;
            n = 0;
            break;
        }
        if(isdigit(x[i])){
            c += (x[i] - '0') * pow(10, n);
            n++;
        }
    }
    i--;
    for (; i >= 0;i--){
        if(x[i]=='2'&&x[i-1]=='^'){
            n = 0;
            break;
        }
        if(x[i]=='+'){
            if (b == 0)
                b = 1;
            n = 0;
            continue;
        }
        else if(x[i]=='-'){
            if (b == 0)
                b = 1;
            b = 0 - b;
            n = 0;
            continue;
        }
        if(isdigit(x[i])){
            b += (x[i] - '0') * pow(10, n);
            n++;
        }
    }
    i = i - 3;
    for (; i >= 0;i--){
        if(x[i]=='-'){
            if (a == 0)
                a = 1;
            a = 0 - a;
            break;
        }
        a += (x[i] - '0') * pow(10, n);
        n++;
    }
    if (a == 0)
        a = 1;
    c -= d;
    for (int j = 0; j < 100;j++)
        if(x[i]=='x'&&x[i+1]!='^')
            haveX = 0;
    if(haveX==0)
        b = 0;
    delta = b * b - 4 * a * c;
    if(delta>0)
        root = 2;
    else if(delta<0){
        delta=0-delta;
        root = 0;
    }
    else
        root = 1;
    switch(root){
        case 2:
            cout << "x1 = " << ((0-b) + sqrt(delta)) / 2 * a << endl;
            cout << "x2 = " << ((0-b) - sqrt(delta)) / 2 * a << endl;
            break;
        case 1:
            cout << "x1 = x2 = " << (0-b) / 2 * a << endl;
            break;
        case 0:
            if(((0-b) / 2 * a)==0){
                cout << "x1 = " <<  sqrt(delta) / 2 * a << 'i' << endl;
                cout << "x2 = " << '-' <<  sqrt(delta) / 2 * a << 'i' << endl;
            }
            else{
                cout << "x1 = " << (0-b) / 2 * a << '+' << sqrt(delta) / 2 * a << 'i' << endl;
                cout << "x2 = " << (0-b) / 2 * a  << sqrt(delta) / 2 * a << 'i' << endl;
            }    
            break;
    }
}

void Exponent(char x[]){    // 指数方程求解
    double a = 0, b = 0, c = 0, d = 0;
    int i = 99, n = 0;
    for (; i >= 0;i--){
        if (x[i] == '='){
            n = 0;
            break;
        }
        if(x[i]=='-'){
            d = 0 - d;
            n = 0;
            continue;
        }
        if(isdigit(x[i])){
            d += (x[i] - '0') * pow(10, n);
            n++;
        }
    }
    i--;
    for (; i >= 0;i--){
        if(x[i]=='x'){
            n = 0;
            break;
        }
        if(x[i]=='+'){
            n = 0;
            break;
        }
        else if(x[i]=='-'){
            c = 0 - c;
            n = 0;
            break;
        }
        if(isdigit(x[i])){
            c += (x[i] - '0') * pow(10, n);
            n++;
        }
    }
    i--;
    for (; i >= 0;i--){
        if(x[i]=='^'){
            n = 0;
            break;
        }
        if(x[i]=='-'){
            if (b == 0)
                b = 1;
            b = 0 - b;
            n = 0;
            continue;
        }
        if(x[i]=='('||x[i]==')')
            continue;
        if(isdigit(x[i])){
            b += (x[i] - '0') * pow(10, n);
            n++;
        }
    }
    if (b == 0)
        b = 1;
    i--;
    for (; i >= 0;i--){
        if(x[i]=='-'){
            if(x[i]=='('||x[i]==')')
                continue;
            if (a == 0)
                a = 1;
            a = 0 - a;
            break;
        }
        a += (x[i] - '0') * pow(10, n);
        n++;
    }
    if (a == 0)
        a = 1;
    d -= c;
    if(a<0&&d<0){
        a = 0 - a;
        d = 0 - d;
    }
    int p = 0, k = 0, isDicimal = 0;
    for (int j = 99; j >= 0;j--){
        if(x[j]=='.'){
            isDicimal = 1;
            break;
        }
        if(x[j])
            k--;
    }
    if(isDicimal)
        d = d * pow(10, k);
    if(x[0]=='-')
        cout << "x = " << 0-((log(d) / log(a)) / b) << endl;
    else
    cout << "x = " << (log(d) / log(a)) / b << endl;
}

void Logarithm(char x[]){   // 对数方程求解
    double a = 0, b = 0, c = 0, d = 0,logdown=0;
    int i = 99, n = 0;
    for (; i >= 0;i--){
        if (x[i] == '='){
            n = 0;
            break;
        }
        if(x[i]=='-'){
            d = 0 - d;
            n = 0;
            continue;
        }
        if(isdigit(x[i])){
            d += (x[i] - '0') * pow(10, n);
            n++;
        }
    }
    i--;
    for (; i >= 0;i--){
        if(x[i]=='x'){
            n = 0;
            break;
        }
        if(x[i]=='+'){
            n = 0;
            continue;
        }
        else if(x[i]=='-'){
            c = 0 - c;
            n = 0;
            continue;
        }
        if(isdigit(x[i])){
            c += (x[i] - '0') * pow(10, n);
            n++;
        }
    }
    i--;
    for (; i >= 0;i--){
        if(x[i]=='g'||x[i]=='n'||x[i]==')'){
            n = 0;
            break;
        }
        if(x[i]=='-'){
            if (b == 0)
                b = 1;
            b = 0 - b;
            n = 0;
            continue;
        }
        if(isdigit(x[i])){
            b += (x[i] - '0') * pow(10, n);
            n++;
        }
    }
    i--;
    if (b == 0)
        b = 1;
    for (; i >= 0;i--){
        if(x[i]=='('){
            i = i - 4;
            n = 0;
            break;
        }
        logdown += (x[i] - '0') * pow(10, n);
        n++;
        if(x[i]=='o'){
            logdown = 10;
            i = i - 2;
            break;
        }   
        else if(x[i]=='l'){
            logdown = 1;
            i = i - 1;
            break;
        }    
    }
    for (; i >= 0;i--){
        if(x[i]=='-'){
            if (a == 0)
                a = 1;
            a = 0 - a;
            break;
        }
        a += (x[i] - '0') * pow(10, n);
        n++;
    }
    if (a == 0)
        a = 1;
    d -= c;
    d = d / a;
    if(logdown==10)
        cout << "x = " << pow(10, d)/b << endl;
    else if(logdown==1)
        cout << "x = " << exp(d)/b << endl;
    else
        cout << "x = " << pow(logdown,d)/b << endl;
}

int main(){
    char x[100]={0};
    int y1,bot=1,err=0;
    system("cls");
    while(1){
        bot = 1;
        cout << "=====================================================================" << endl;
        cout <<"                           请选择功能" << endl;
        cout << "                           1.进制转换" << endl;
        cout << "                         2.进制四则运算" << endl;
        cout<< "                          3.科学计算器"<< endl;
        cout<< "                           0.退出程序" << endl;
        cout << "====================================================================="<<endl;
        cin >> y1;
        system("cls");
        if (y1 == 1){
            bot = 1;
            while(1){
                err = 0;
                if(bot==0)
                    break;
                cout << "请输入数字：";
                cin >> x;
                if((x[0] == '0'&&x[1] == 'b') || (x[0] == '0'&& x[1] == 'B')){
                    int j = 31,decNum = 0;
                    err = biErr(x);
                    if(err){
                        cout << "=====================================================================" << endl;
                        cout << "                        输入有误，请重新输入！" << endl;
                        cout << "=====================================================================" << endl;
                        continue;
                    }
                    cout << "此数字是二进制值" << endl;
                    getBi(x);
                    decNum=BiToDec(bi);
                    BiToOct(bi);
                    cout << "十进制值：" << decNum << endl;
                    cout << "十六进制值：";
                    BiToHex(bi);
                }
                else if ((x[0] == '0'&&x[1] == 'x') || (x[0] == '0'&& x[1] == 'X')){    // 十六进制
                    err = hexErr(x);
                    if(err){
                        cout << "=====================================================================" << endl;
                        cout << "                        输入有误，请重新输入！" << endl;
                        cout << "=====================================================================" << endl;
                        continue;
                    }
                    cout << "此数字是十六进制值" << endl;
                    int decNum = HexToDec(x);
                    DecToBinary(decNum);
                    cout << "二进制值：";
                    printBinary(bi);
                    BiToOct(bi);
                    cout << "十进制值：" << decNum << endl;
                }
                else if(x[0]=='0'&&isdigit(x[1])){
                    err = octErr(x);
                    if(err){
                        cout << "=====================================================================" << endl;
                        cout << "                        输入有误，请重新输入！" << endl;
                        cout << "=====================================================================" << endl;
                        continue;
                    }
                    cout << "此数字是八进制值" << endl;
                    int decNum = OctToDec(x);
                    DecToBinary(decNum);
                    cout << "二进制值：";
                    printBinary(bi);
                    cout << "十进制值：" << decNum << endl;
                    cout << "十六进制值：";
                    BiToHex(bi);
                }
                else if(isdigit(x[0])||x[0]=='-'){
                    int decNum = getDec(x);
                    cout << "此数字是十进制值" << endl;
                    DecToBinary(decNum);
                    cout << "二进制值：";
                    printBinary(bi);
                    BiToOct(bi);
                    cout << "十六进制值：";
                    BiToHex(bi);
                }
                else{
                    cout << "=====================================================================" << endl;
                    cout << "                        输入有误，请重新输入！" << endl;
                    cout << "=====================================================================" << endl;
                    continue;
                }
                memset(x, 0, sizeof(x));
                memset(bi, 0 , sizeof(bi));
                memset(octal, 0 , sizeof(octal));
                memset(hexa, 0, sizeof(hexa));
                cout << "=====================================================================" << endl;
                cout << "            是否继续计算？ 1. 是            0.返回" << endl;
                cout << "=====================================================================" << endl;
                cin >> bot;
                system("cls");
            }
        }
        else if (y1 == 2){
            system("cls");
            int y2;
            while(1){
                bot = 1;
                cout << "=====================================================================" << endl;
                cout << "                        请选择需要运算的进制：" << endl;
                cout << "                         1.二进制四则运算" << endl;
                cout << "                         2.十进制四则运算" << endl;
                cout << "                        3.十六进制四则运算" << endl;
                cout << "                            0.上一步" << endl;
                cout << "=====================================================================" << endl;
                cin >> y2;
                system("cls");
                if(y2==1){
                    while(1){
                        int j = 31,result=0,leap=1;
                        char Num[32] = {0},sign;
                        int biNum[32] = {0}, decNum;
                        if(bot==0)
                            break;
                        cout << "请输入数字：(在输入符号处输入0结束运算)" << endl;
                        while (1) {
                            memset(Num, 0, sizeof(Num));
                            memset(biNum, 0, sizeof(biNum));
                            cin >> Num;
                            err = biErr(Num);
                            if(err){
                                cout << "=====================================================================" << endl;
                                cout << "                        输入有误，请重新输入！" << endl;
                                cout << "=====================================================================" << endl;
                                err = 0;
                                cout << "请输入数字：" << endl;
                                continue;
                            }
                            for (int i = 31; i >= 0; i--){
                                if (Num[i]){
                                    biNum[j] = Num[i] - '0';
                                    j--;
                                }
                            }
                            j = 31;
                            decNum = BiToDec(biNum);
                            if (leap)
                                result = decNum;
                            if (!leap) {
                                switch (sign) {
                                case '+':
                                    result += decNum;
                                    break;
                                case '-':
                                    result -= decNum;
                                    break;
                                case '*':
                                    result *= decNum;
                                    break;
                                case '/':
                                    result /= decNum;
                                    break;
                                }
                            }
                            while(1){
                                cout << "请输入运算符号（+、-、*、/）：" << endl;
                                cin >> sign;
                                if(sign!='+'&&sign!='-'&&sign!='/'&&sign!='*'&&sign!='0'){
                                    cout << "=====================================================================" << endl;
                                    cout << "                        输入有误，请重新输入！" << endl;
                                    cout << "=====================================================================" << endl;
                                    err = 0;
                                    continue;
                                }
                                else
                                    break;
                            }
                            if (leap){
                                cout << "请输入数字：" << endl;
                                leap = 0;
                                continue;
                            }
                            if (!leap)
                                cout << "请输入数字：" << endl;
                            if (sign == '0')
                                break;
                        }
                        cout << "结果是：" ;
                        DecToBinary(result);
                        printBinary(bi);
                        memset(bi, 0, sizeof(bi));
                        cout << "=====================================================================" << endl;
                        cout << "            是否继续计算？ 1. 是            0.返回" << endl;
                        cout << "=====================================================================" << endl;
                        cin >> bot;
                        system("cls");
                    }
                }
                else if(y2==2){
                    while(1){
                        int leap = 1, n = 0, isDecimal = 0, isNeg = 0, k = 0;
                        char sign,Num[100]={0};
                        double result=0,decNum=0;
                        if(bot==0)
                            break;
                        cout << "请输入数字：(在输入符号处输入0结束运算)" << endl;
                        while(1){
                            memset(Num, 0, sizeof(Num));
                            n = 0,decNum=0,isDecimal=0,isNeg = 0,k=0;
                            cin >> Num;
                            err = decErr(Num);
                            if(err){
                                cout << "=====================================================================" << endl;
                                cout << "                        输入有误，请重新输入！" << endl;
                                cout << "=====================================================================" << endl;
                                err = 0;
                                cout << "请输入数字：" << endl;
                                continue;
                            }
                            for (int i = 99; i >= 0;i--){
                                if(Num[i]=='.'||Num[i]=='-')
                                    continue;
                                if(Num[i]) {
                                    decNum += (Num[i] - '0') * pow(10, n);
                                    n++;
                                }
                            }
                            for (int i = 0; i < 100;i++){
                                if(Num[i]=='.')
                                    isDecimal = 1;
                            }
                            
                            if(isDecimal){
                                for (int i = 99; i >= 0;i--){
                                    if(Num[i]=='.')
                                        break;
                                    if(Num[i])
                                        k--;
                                }
                                decNum = decNum * pow(10, k);
                            }
                            if(Num[0]=='-')
                                decNum = 0 - decNum;
                            if (leap)
                                result = decNum;
                            if(!leap){
                                switch(sign){
                                case '+':
                                    result += decNum;
                                    break;
                                case '-':
                                    result -= decNum;
                                    break;
                                case '*':
                                    result *= decNum;
                                    break;
                                case '/':
                                    result /= decNum;
                                    break;
                                }
                            }
                            while(1){
                                cout << "请输入运算符号（+、-、*、/）：" << endl;
                                cin >> sign;
                                if(sign!='+'&&sign!='-'&&sign!='/'&&sign!='*'&&sign!='0'){
                                    cout << "=====================================================================" << endl;
                                    cout << "                        输入有误，请重新输入！" << endl;
                                    cout << "=====================================================================" << endl;
                                    continue;
                                }
                                else
                                    break;
                            }
                            if(leap){
                                cout << "请输入数字：" << endl;
                                leap = 0;
                                continue;
                            }
                            if(sign=='0')
                                break;
                        }
                        cout << "结果是：" << result << endl;
                        cout << "=====================================================================" << endl;
                        cout << "            是否继续计算？ 1. 是            0.返回" << endl;
                        cout << "=====================================================================" << endl;
                        cin >> bot;
                        system("cls");
                    }
                }
                else if(y2==3){
                    while(1){
                        int result=0,leap=1;
                        char Num[10] = {0},sign;
                        int  decNum;
                        if(bot==0)
                            break;
                        cout << "请输入数字：(在输入符号处输入0结束运算)" << endl;
                        while(1){
                            memset(Num, 0, sizeof(Num));
                            memset(bi, 0, sizeof(bi));
                            cin >> Num;
                            for (int i = 7; i >=0;i--){
                                if(Num[i])
                                    Num[i+2] = Num[i];
                            }
                            Num[0] = '0', Num[1] = 'x';
                            err=hexErr(Num);
                            if(err){
                                cout << "=====================================================================" << endl;
                                cout << "                        输入有误，请重新输入！" << endl;
                                cout << "=====================================================================" << endl;
                                err = 0;
                                cout << "请输入数字：" << endl;
                                continue;
                            }
                            decNum = HexToDec(Num);
                            if(leap)
                                result = decNum;
                            if(!leap){
                                switch(sign){
                                case '+':
                                    result += decNum;
                                    break;
                                case '-':
                                    result -= decNum;
                                    break;
                                case '*':
                                    result *= decNum;
                                    break;
                                case '/':
                                    result /= decNum;
                                    break;
                                }
                            }
                            while(1){
                                cout << "请输入运算符号（+、-、*、/）：" << endl;
                                cin >> sign;
                                if(sign!='+'&&sign!='-'&&sign!='/'&&sign!='*'&&sign!='0'){
                                    cout << "=====================================================================" << endl;
                                    cout << "                        输入有误，请重新输入！" << endl;
                                    cout << "=====================================================================" << endl;
                                    continue;
                                }
                                else
                                    break;
                            }
                            if(leap){
                                cout << "请输入数字：" << endl;
                                leap = 0;
                                continue;
                            }
                            if(!leap)
                                cout << "请输入数字：" << endl;
                            if(sign=='0')
                                break;
                        }
                        DecToBinary(result);
                        cout << "结果是：";
                        BiToHex(bi);
                        cout << "=====================================================================" << endl;
                        cout << "            是否继续计算？ 1. 是            0.返回" << endl;
                        cout << "=====================================================================" << endl;
                        cin >> bot;
                        system("cls");
                    }
                }
                else if(y2==0){
                    system("cls");
                    break;
                }
                else{
                    cout << "=====================================================================" << endl;
                    cout << "                        输入有误，请重新输入！" << endl;
                    cout << "=====================================================================" << endl;
                    continue;
                }
                memset(bi, 0 , sizeof(bi));
                memset(hexa, 0, sizeof(hexa));
            }
        }
        else if (y1 == 3){
            int y3, n = 0;
            while(1){
                bot = 1;
                double result = 0;
                cout << "=====================================================================" << endl;
                cout << "                       请输入需要运算的类型：" << endl;
                cout << "                1.对数、幂运算，三角函数(角度制)计算" << endl;
                cout << "         2.任意两个进制数字之间比较运算，公约数，最小公倍数计算" << endl;
                cout << "                           3.函数运算" << endl;
                cout << "                          0.返回上一步"<< endl;
                cout << "=====================================================================" << endl;
                cin >> y3;
                system("cls");
                if(y3==1){
                    while(1){
                        memset(x, 0, sizeof(x));
                        int yy;
                        result = 0;
                        if(bot == 0)
                            break;
                        cout << "请输入表达式：";
                        cin >> x;
                        for(int i=0;i<100;i++){
                            if(x[i]=='e'){
                                yy = 1;
                                break;
                            }
                            else if(x[i]=='s'||x[i]=='c'||x[i]=='t'){
                                yy = 2;
                                break;
                            }
                            else if(x[i]=='l'){
                                yy = 3;
                                break;
                            }
                            else if(x[i]=='^'){
                                yy = 4;
                                break;
                            }
                        }
                        if(yy==1){
                            powE(x);
                        }
                        else if(yy==2){
                            funTri(x);
                        }
                        else if(yy==3){
                            double a = 0, b = 0,logdown=0;
                            int i = 99, j = 99, n = 0,k=0,isDecimal=0,isE=0;
                            for (; i >= 0;i--){
                                if(x[i]=='g'||x[i]=='n'||x[i]==')'){
                                    n = 0;
                                    break;
                                }
                                if(x[i]=='-')
                                    break;
                                if(isdigit(x[i])){
                                    b += (x[i] - '0') * pow(10, n);
                                    n++;
                                }
                            }
                            i--;
                            for (; j >= 0;j--){
                                if(x[j]=='g'||x[j]=='n'||x[j]==')')
                                    break;
                                if(x[j]=='.'){
                                    isDecimal = 1;
                                    continue;
                                }
                                if(x[j]=='('||x[j]==')')
                                    continue;
                                if(x[j]&&!isDecimal)
                                    k--;
                            }
                            if(isDecimal){
                                b *= pow(10, k);
                                k = 0;
                                isDecimal = 0;
                            }
                            j--;
                            k = 0;
                            for (; i >= 0;i--){
                                if(x[i]=='.'){
                                    isDecimal = 1;
                                    continue;
                                }
                                if(x[i]=='-')
                                    err = 1;
                                if(x[i]=='('){
                                    i = i - 4;
                                    j = j - 4;
                                    n = 0;
                                    break;
                                }
                                else if(x[i]=='o'){
                                    logdown = 10;
                                    i = i - 2;
                                    j = j - 2;
                                    break;
                                }   
                                else if(x[i]=='l'){
                                    isE = 1;
                                    i = i - 1;
                                    j = j - 1;
                                    break;
                                }
                                if(x[i]&&!isDecimal)
                                    k--;
                                logdown += (x[i] - '0') * pow(10, n);
                                n++;
                            }
                            if(isDecimal){
                                logdown *= pow(10, k);
                                k = 0;
                                isDecimal = 0;
                            }
                            for (; i >= 0;i--){
                                if(x[i]=='-'){
                                    if (a == 0)
                                        a = 1;
                                    a = 0 - a;
                                    break;
                                }
                                a += (x[i] - '0') * pow(10, n);
                                n++;
                            }
                            if (a == 0)
                                a = 1;
                            for (; j >= 0;j--){
                                if(x[j]=='.'){
                                    isDecimal = 1;
                                    continue;
                                }
                                if(x[j]==')'||x[j]=='(')
                                    continue;
                                if(x[j]&&!isDecimal)
                                    k--;
                            }
                            if(isDecimal){
                                a *= pow(10, k);
                                isDecimal = 0;
                            }
                            if(b<=0||a<=0||logdown==1||err){
                                cout << "=====================================================================" << endl;
                                cout << "                        输入有误，请重新输入！" << endl;
                                cout << "=====================================================================" << endl;
                                err = 0;
                                continue;
                            }
                            if(logdown==10)
                                cout << "结果是：" << a*log10(b) << endl;
                            else if(isE)
                                cout << "结果是：" << a*log(b) << endl;
                            else
                                cout << "结果是：" << a*(log(b)/log(logdown)) << endl;
                        }
                        else if(yy==4){
                            Power(x);
                        }
                        else{
                            cout << "=====================================================================" << endl;
                            cout << "                        输入有误，请重新输入！" << endl;
                            cout << "=====================================================================" << endl;
                            continue;
                        }
                        cout << "=====================================================================" << endl;
                        cout << "            是否继续计算？ 1. 是            0.返回" << endl;
                        cout << "=====================================================================" << endl;
                        cin >> bot;
                        system("cls");
                    }
                }
                else if(y3==2){
                    while(1){
                        int decNum1=0, decNum2=0, leap = 1;
                        char y[100] = {0};
                        memset(x, 0, sizeof(x));
                        memset(y, 0, sizeof(y));
                        if(bot == 0)
                            break;
                        cout << "请输入第一个数字（由前缀表示进制数）：" ;
                        cin >> x;
                        while(1){
                            if((x[0]=='0'&&x[1]=='b')||(x[0]=='0'&&x[1]=='B')){
                                getBi(x);
                                cout << bi << endl;
                                if(leap){
                                    decNum1 = BiToDec(bi);
                                }
                                else{
                                    decNum2 = BiToDec(bi);
                                }
                            }
                            else if((x[0]=='0'&&x[1]=='x')||(x[0]=='0'&&x[1]=='X')){
                                if(leap){
                                    decNum1 = HexToDec(x);
                                }
                                else
                                    decNum2 = HexToDec(x);
                            }
                            else if(x[0]=='0'&&isdigit(x[1])){
                                if(leap){
                                    decNum1=OctToDec(x);
                                }
                                else
                                    decNum2 = OctToDec(x);
                            }
                            else{
                                if(leap){
                                    decNum1=getDec(x);
                                }
                                else
                                    decNum2 = getDec(x);
                            }
                            memset(bi, 0, sizeof(bi));
                            if(leap==0)
                                break;
                            leap = 0;
                            for (int i = 0; i < 100;i++){
                                    y[i] = x[i];
                            }
                            cout << "请输入第二个数字" ;
                            memset(x, 0, sizeof(x));
                            cin >> x;
                        }
                        cout <<"结果是："<< y;
                        if(decNum1>decNum2)
                            cout << " > ";
                        else if(decNum1<decNum2)
                            cout << " < ";
                        else
                            cout << " = ";
                        cout << x << endl;
                        printMulAndDiv(decNum1, decNum2);
                        cout << "=====================================================================" << endl;
                        cout << "            是否继续计算？ 1. 是            0.返回" << endl;
                        cout << "=====================================================================" << endl;
                        cin >> bot;
                        system("cls");
                    }
                }
                else if(y3==3){
                    while(1){
                        memset(x, 0, sizeof(x));
                        if(bot == 0)
                            break;
                        int y4 = 0;
                        cout << "请输入方程表达式：";
                        cin >> x;
                        for (int i = 0; i < 100; i++){
                            if(x[i]=='x'&&x[i+1]=='^'&&x[i+2]=='2'){
                                y4 = 3;
                                break;
                            }
                            else if(x[i]=='/'&&x[i+1]=='x'){
                                y4 = 2;
                                break;
                            }
                            else if(x[i]=='l'){
                                y4 = 4;
                                break;
                            }
                            else if(x[i]=='x'){
                                y4 = 1;
                                break;
                            }
                            else if(x[0]=='0'){
                                y4 = 0;
                                break;
                            }
                        }
                        if (y4 == 0){
                            cout << "=====================================================================" << endl;
                            cout << "                        输入有误，请重新输入！" << endl;
                            cout << "=====================================================================" << endl;
                            break;
                        }
                        cout << "结果是：" << endl;
                        if (y4 == 1){
                            Inverse(x);
                        }
                        else if (y4 == 2){
                            Oneoff(x);
                        }
                        else if (y4 == 3){
                            Quadratic(x);
                        }
                        else if (y4 == 4){
                            Logarithm(x);
                        }
                        cout << "=====================================================================" << endl;
                        cout << "            是否继续计算？ 1. 是            0.返回" << endl;
                        cout << "=====================================================================" << endl;
                        cin >> bot;
                        system("cls");
                    }
                }
                else if(y3==0){
                    system("cls");
                    break;
                }
                else{
                    cout << "=====================================================================" << endl;
                    cout << "                        输入有误，请重新输入！" << endl;
                    cout << "=====================================================================" << endl;
                    continue;
                }
            }
        }   
        else if (y1 == 0){
            system("cls");
            cout << "=====================================================================" << endl;
            cout << "                            程序已退出！" << endl;
            break;
        }
        else{
            cout << "=====================================================================" << endl;
            cout << "                        输入有误，请重新输入！" << endl;
            cout << "=====================================================================" << endl;
        }
    }
    cout << "=====================================================================";

    return 0;
}
